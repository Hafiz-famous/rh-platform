<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="x-apple-disable-message-reformatting">
    <meta name="format-detection" content="telephone=no,date=no,address=no,email=no,url=no">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nouvelle demande de congé</title>
    <style>
      /* Reset minimal pour e-mails */
      body,table,td,a { -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%; }
      table,td { mso-table-lspace:0pt; mso-table-rspace:0pt; }
      img { -ms-interpolation-mode:bicubic; border:0; outline:none; text-decoration:none; }
      table { border-collapse:collapse !important; }
      body { margin:0; padding:0; width:100% !important; }
      /* Empêche iOS de recolorer */
      a[x-apple-data-detectors] { color:inherit !important; text-decoration:none !important; }
      /* Styles de base */
      .bg { background:#f6f7f9; }
      .wrap { width:100%; max-width:600px; margin:0 auto; }
      .card { background:#ffffff; border-radius:12px; border:1px solid #e8ecf1; }
      .p-24 { padding:24px; }
      .muted { color:#6b7280; font-size:13px; }
      .h1 { font:700 20px/1.3 system-ui,Segoe UI,Roboto,Arial,sans-serif; color:#0f172a; margin:0 0 6px; }
      .text { font:400 15px/1.6 system-ui,Segoe UI,Roboto,Arial,sans-serif; color:#111827; }
      .btn { display:inline-block; background:#198754; color:#ffffff !important; padding:12px 18px; border-radius:8px; text-decoration:none; font:700 14px/1 system-ui,Segoe UI,Roboto,Arial,sans-serif; }
      .btn:visited { color:#ffffff !important; }
      .hr { height:1px; background:#eef2f7; border:0; margin:20px 0; }
      .foot { font:400 12px/1.6 system-ui,Segoe UI,Roboto,Arial,sans-serif; color:#6b7280; }
      @media (max-width: 620px){
        .p-24 { padding:18px !important; }
        .h1 { font-size:18px !important; }
      }
    </style>
  </head>
  <body class="bg" style="background:#f6f7f9;">
    <!-- Preheader (aperçu boîte de réception) -->
    <div style="display:none;max-height:0;overflow:hidden;opacity:0;">
      Nouvelle demande de congé soumise par {{ employee_name }} ({{ start_date.strftime('%d/%m/%Y') }} → {{ end_date.strftime('%d/%m/%Y') }}).
    </div>

    <table role="presentation" width="100%" class="bg" cellpadding="0" cellspacing="0">
      <tr>
        <td align="center" style="padding:24px;">
          <table role="presentation" width="100%" class="wrap" cellpadding="0" cellspacing="0">
            <tr>
              <td align="left" class="p-24 card">
                <!-- En-tête -->
                <table role="presentation" width="100%">
                  <tr>
                    <td>
                      <h1 class="h1">Nouvelle demande de congé</h1>
                      <div class="muted">ID demande&nbsp;: #{{ leave_id }}</div>
                    </td>
                  </tr>
                </table>

                <div class="text" style="margin-top:14px;">
                  Bonjour,
                  <br><br>
                  Une nouvelle demande de congé a été soumise par
                  <strong>{{ employee_name }}</strong>
                  {% if leave_type %}(type&nbsp;: {{ leave_type|replace('_',' ')|title }}){% endif %},
                  pour la période du
                  <strong>{{ start_date.strftime('%d/%m/%Y') }}</strong>
                  au
                  <strong>{{ end_date.strftime('%d/%m/%Y') }}</strong>.
                </div>

                <!-- CTA -->
                <table role="presentation" cellpadding="0" cellspacing="0" style="margin:18px 0 6px;">
                  <tr>
                    <td>
                      <!-- Bouton “bulletproof” (VML pour Outlook) -->
                      <!--[if mso]>
                      <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" href="{{ url }}" style="height:40px;v-text-anchor:middle;width:220px;" arcsize="10%" stroke="f" fillcolor="#198754">
                        <w:anchorlock/>
                        <center style="color:#ffffff;font-family:Segoe UI, Arial, sans-serif;font-size:14px;font-weight:700;">
                          Ouvrir la console
                        </center>
                      </v:roundrect>
                      <![endif]-->
                      <!--[if !mso]><!-- -->
                      <a class="btn" href="{{ url }}" target="_blank" rel="noopener">Ouvrir la console</a>
                      <!--<![endif]-->
                    </td>
                  </tr>
                </table>

                <hr class="hr">

                <table role="presentation" cellpadding="0" cellspacing="0" width="100%" class="text">
                  <tr>
                    <td width="34%" style="padding:4px 0;color:#6b7280;">Salarié</td>
                    <td style="padding:4px 0;"><strong>{{ employee_name }}</strong></td>
                  </tr>
                  {% if leave_type %}
                  <tr>
                    <td style="padding:4px 0;color:#6b7280;">Type</td>
                    <td style="padding:4px 0;">{{ leave_type|replace('_',' ')|title }}</td>
                  </tr>
                  {% endif %}
                  <tr>
                    <td style="padding:4px 0;color:#6b7280;">Période</td>
                    <td style="padding:4px 0;">{{ start_date.strftime('%d/%m/%Y') }} → {{ end_date.strftime('%d/%m/%Y') }}</td>
                  </tr>
                  <tr>
                    <td style="padding:4px 0;color:#6b7280;">ID</td>
                    <td style="padding:4px 0;">#{{ leave_id }}</td>
                  </tr>
                </table>

                <div class="foot" style="margin-top:18px;">
                  Vous recevez cet e-mail car vous êtes gestionnaire ou administrateur sur RH Platform.
                </div>
              </td>
            </tr>
            <tr>
              <td align="center" class="muted" style="padding:16px 8px; font-size:12px;">
                © {{ now().year if now is defined else "" }} RH Platform — Notification automatique
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </body>
</html>
